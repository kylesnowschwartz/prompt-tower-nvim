# prompt-tower.nvim

A Neovim plugin for creating AI-ready context from your codebase. Inspired by the VSCode Prompt Tower extension.

## Features

- üìÅ **File Selection**: Choose files for context generation with simple commands
- üîÑ **Context Generation**: Create structured prompts for AI assistants  
- üìã **Clipboard Integration**: Automatically copy generated context to clipboard
- ‚öôÔ∏è **Configurable**: Extensive configuration options for output formatting
- üß™ **Well Tested**: Comprehensive test suite using plenary.nvim

## Installation

### Using [lazy.nvim](https://github.com/folke/lazy.nvim)

```lua
{
  'your-username/prompt-tower.nvim',
  dependencies = {
    'nvim-lua/plenary.nvim', -- Required for file operations
  },
  config = function()
    require('prompt-tower').setup({
      -- Configuration options (see below)
    })
  end,
}
```

### Using [packer.nvim](https://github.com/wbthomason/packer.nvim)

```lua
use {
  'your-username/prompt-tower.nvim',
  requires = {
    'nvim-lua/plenary.nvim',
  },
  config = function()
    require('prompt-tower').setup()
  end
}
```

## Quick Start

1. **Select files for context**:
   ```vim
   :PromptTowerSelect  " Add current file to selection
   ```

2. **Generate and copy context**:
   ```vim
   :PromptTowerGenerate  " Generate context and copy to clipboard
   ```

3. **Clear selection**:
   ```vim
   :PromptTowerClear  " Remove all files from selection
   ```

## Commands

| Command | Description |
|---------|-------------|
| `:PromptTower` | Open file selection interface (coming soon) |
| `:PromptTowerSelect` | Add current file to selection |
| `:PromptTowerGenerate` | Generate context from selected files |
| `:PromptTowerClear` | Clear all selected files |
| `:PromptTowerToggle [file]` | Toggle file selection |

## Configuration

Default configuration:

```lua
require('prompt-tower').setup({
  -- File discovery settings
  ignore_patterns = {
    '.git', 'node_modules', '.DS_Store', '*.pyc', '__pycache__',
    '.pytest_cache', '.venv', 'venv', 'target', 'build', 'dist',
    '.next', '.nuxt',
  },
  use_gitignore = true,
  use_towerignore = true,
  max_file_size_kb = 1024,
  
  -- Context generation settings
  output_format = {
    block_template = '<file path="{filepath}">\\n{content}\\n</file>',
    separator = '\\n\\n',
    include_tree = true,
    tree_template = '<project_tree>\\n{tree}\\n</project_tree>\\n\\n',
    wrapper_template = '<!-- Generated by prompt-tower.nvim -->\\n<!-- {file_count} files selected -->\\n\\n{tree_block}{file_blocks}',
  },
  
  -- Token counting (estimation)
  token_estimation = {
    chars_per_token = 4,
    show_warnings = true,
    warning_threshold = 8000,
  },
  
  -- UI settings
  ui = {
    border = 'rounded',
    width = 0.8,
    height = 0.8,
    title = 'Prompt Tower',
    show_help = true,
  },
  
  -- Clipboard settings
  clipboard = {
    register = '+', -- System clipboard
    notify_on_copy = true,
  },
})
```

## Development

### Requirements

- Neovim 0.8+
- [plenary.nvim](https://github.com/nvim-lua/plenary.nvim) for testing

### Running Tests

```bash
# Run all tests
make test

# Run specific test file
make test-file FILE=tests/config_spec.lua

# Check syntax and style
make lint

# Format code
make format
```

### Project Structure

```
prompt-tower-nvim/
‚îú‚îÄ‚îÄ lua/prompt-tower/
‚îÇ   ‚îú‚îÄ‚îÄ init.lua              # Main entry point
‚îÇ   ‚îú‚îÄ‚îÄ config.lua            # Configuration management
‚îÇ   ‚îú‚îÄ‚îÄ services/             # Business logic (planned)
‚îÇ   ‚îú‚îÄ‚îÄ models/               # Data structures (planned)
‚îÇ   ‚îî‚îÄ‚îÄ ui/                   # User interface (planned)
‚îú‚îÄ‚îÄ plugin/prompt-tower.lua   # Plugin registration
‚îú‚îÄ‚îÄ tests/                    # Test files
‚îî‚îÄ‚îÄ Makefile                  # Development tasks
```

## Roadmap

### Phase 1: MVP ‚úÖ
- [x] Basic plugin structure
- [x] Configuration system
- [x] File selection commands
- [x] Basic context generation
- [x] Test framework

### Phase 2: Core Features (In Progress)
- [ ] File discovery service with ignore patterns
- [ ] File tree display
- [ ] Template system for output formatting
- [ ] Token counting and estimation

### Phase 3: Enhanced Features (Planned)
- [ ] Floating window UI
- [ ] Telescope integration
- [ ] GitHub issues integration
- [ ] Project tree visualization

### Phase 4: Advanced Features (Planned)
- [ ] Multi-workspace support
- [ ] AI provider integration
- [ ] Performance optimizations
- [ ] Advanced filtering options

## Contributing

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Make your changes and add tests
4. Run tests (`make test`)
5. Commit your changes (`git commit -m 'Add amazing feature'`)
6. Push to the branch (`git push origin feature/amazing-feature`)
7. Open a Pull Request

## License

MIT License - see LICENSE file for details.

## Acknowledgments

- Inspired by [Prompt Tower VSCode Extension](https://github.com/backnotprop/prompt-tower)
- Built with [plenary.nvim](https://github.com/nvim-lua/plenary.nvim)
- Follows [Neovim plugin development best practices](https://github.com/nanotee/nvim-lua-guide)